# ==============================================================================
# Quantum-Chain Docker Compose - Development Override
# ==============================================================================
# This overlay mounts source code for hot-reload development.
# The binary is compiled on host and mounted into container.
#
# Usage:
#   1. Build locally: cargo build --release
#   2. Run with overlay: docker compose -f docker-compose.yml -f docker-compose.dev.yml up
#
# Or use the dev script:
#   ./scripts/dev-run.sh
# ==============================================================================

services:
  quantum-chain:
    build:
      context: ..
      dockerfile: docker/Dockerfile.dev
    volumes:
      # Mount the locally-built binary (build on host, run in container)
      - ../target/release/node-runtime:/usr/local/bin/quantum-chain:ro
      # Mount config for live changes
      - ../config:/var/quantum-chain/config:ro
      # Persistent data
      - qc-data:/var/quantum-chain/data
    environment:
      QC_LOG_LEVEL: info
      RUST_BACKTRACE: full
      RUST_LOG: "info,qc_17_block_production=info,qc_02_block_storage=info,qc_08_consensus=info,qc_09_finality=info,qc_06_mempool=info,node_runtime=info,event_flow=info"
